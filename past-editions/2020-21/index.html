<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Slides 2020/2021 edition #   This edition was taught by Lawrence Mitchell).   Slides as annotated during the live lectures. Recordings of the live sessions are available if you&rsquo;re appropriately logged in. If you think you should have access but don&rsquo;t, please get in touch.
  Session 1, video.
  Session 2, video.
  Session 3, and the roofline paper, video part I and part II."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Edition 2020/2021"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://scicomp-durham.github.io/COMP52315/past-editions/2020-21/"><title>Edition 2020/2021 | COMP52315 – Performance Engineering, Vectorisation and GPU Programming</title><link rel=icon href=/COMP52315/favicon.svg type=image/x-icon><link rel=stylesheet href=/COMP52315/book.min.0cb0b7d6a1ed5d0e95321cc15edca4d6e9cc406149d1f4a3f25fd532f6a3bb38.css integrity="sha256-DLC31qHtXQ6VMhzBXtyk1unMQGFJ0fSj8l/VMvajuzg="></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><div class=book-brand><img class=book-center src=/COMP52315/logo.svg alt=Logo><h2><a href=/COMP52315>COMP52315 – Performance Engineering, Vectorisation and GPU Programming</a></h2></div><ul><li><span>Course resources</span><ul><li><a href=/COMP52315/setup/contact/>Contact details</a></li><li><a href=/COMP52315/setup/hamilton/>Hamilton accounts</a></li><li><a href=/COMP52315/setup/configuration/>ssh configuration</a></li><li><a href=/COMP52315/setup/unix/>Unix resources</a></li></ul></li><li><a href=/COMP52315/journal/>Journal</a></li><li><a href=/COMP52315/exercises/>Exercises</a><ul></ul></li><li><a href=/COMP52315/notes/>Notes</a><ul></ul></li><li><a href=/COMP52315/resources/>Further resources</a></li><li><a href=/COMP52315/acknowledgements/>Acknowledgements</a></li><li><a href=/COMP52315/past-editions/>Past editions</a><ul><li><a href=/COMP52315/past-editions/2020-21/ class=active>Edition 2020/2021</a><ul></ul></li><li><a href=/COMP52315/past-editions/2021-22/>Edition 2021/2022</a><ul></ul></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/COMP52315/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Edition 2020/2021</strong>
<label for=toc-control><img src=/COMP52315/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#slides-20202021-edition>Slides 2020/2021 edition</a></li></ul></nav></aside></header><article class=markdown><h1 id=slides-20202021-edition>Slides 2020/2021 edition
<a class=anchor href=#slides-20202021-edition>#</a></h1><blockquote class="book-hint info"><span>This edition was taught by <a href=mailto:lawrence@wence.uk>Lawrence Mitchell</a>).</span></blockquote><p>Slides as annotated during the live lectures. Recordings of the live
sessions are available if you&rsquo;re appropriately logged in. If you think
you should have access but don&rsquo;t, please <a href=mailto:lawrence@wence.uk>get in
touch</a>.</p><ul><li><p><a href=https://scicomp-durham.github.io/COMP52315/lecture-slides/2020-21/01.pdf>Session 1</a>, <a href=https://web.microsoftstream.com/video/47a15875-eddc-48b3-ac17-6b68ee46a8d6>video</a>.</p></li><li><p><a href=https://scicomp-durham.github.io/COMP52315/lecture-slides/2020-21/02.pdf>Session 2</a>, <a href=https://web.microsoftstream.com/video/ecf53b07-636e-4ffa-abe8-fe697230d56c>video</a>.</p></li><li><p><a href=https://scicomp-durham.github.io/COMP52315/lecture-slides/2020-21/03.pdf>Session 3</a>, and the <a href=https://scicomp-durham.github.io/COMP52315/lecture-slides/2020-21/williams2009-roofline.pdf>roofline
paper</a>,
<a href=https://web.microsoftstream.com/video/ba7827a0-3146-4396-afde-b51082729f8c>video part I</a>
and <a href=https://web.microsoftstream.com/video/7c448687-e366-4492-8434-d0e98b5f556d>part II</a>.</p></li><li><p><a href=https://scicomp-durham.github.io/COMP52315/lecture-slides/2020-21/04.pdf>Session 4</a>, <a href=https://web.microsoftstream.com/video/7c448687-e366-4492-8434-d0e98b5f556d>video</a>.
I got a bit confused towards the end in the exercises determining
why likwid was reporting load counts different from those we were
expecting. We worked this out (thanks Finlay) by the next session:
the compiler was inlining some code and producing some extra moves.</p></li><li><p><a href=https://scicomp-durham.github.io/COMP52315/lecture-slides/2020-21/05.pdf>Session 5</a>, <a href=https://web.microsoftstream.com/video/86b11649-7c68-4739-a3e9-4727ee9d0621>video</a>.</p></li><li><p><a href=https://scicomp-durham.github.io/COMP52315/lecture-slides/2020-21/06.pdf>Session 6</a>, <a href=https://web.microsoftstream.com/video/61b6b896-af83-4a6f-b7b0-0d7f968cf789>video</a>.
I went over the end of the cache blocking for matrix-matrix
multiplication again, and then we looked briefly at the performance
we obtained on Hamilton. We then looked at how we can convince our
compiler to generate the code we know is right. As mentioned, in my
experience, of Intel, GCC, and Clang, the Intel compiler is the best
in terms of optimisation reports. Flags for Intel are in the slides.
For GCC, we can get some reports with <code>-fopt-info</code> (see <a href=https://gcc.gnu.org/onlinedocs/gcc/Developer-Options.html>this
page</a> and
search for <code>-fopt-info</code>). For Clang, we can get some reports with
<code>-Rpass=vec</code> and <code>-Rpass-missed=vec</code> (see <a href=https://clang.llvm.org/docs/UsersManual.html#options-to-emit-optimization-reports>this
page</a>).</p></li><li><p><a href=https://scicomp-durham.github.io/COMP52315/lecture-slides/2020-21/07.pdf>Session 7</a>, I also annotated one page from
the <a href=https://scicomp-durham.github.io/COMP52315/lecture-slides/2020-21/vanzee2015-blis.pdf>BLIS paper</a>, <a href=https://web.microsoftstream.com/video/994cf8c0-6403-48a0-85fd-b0d6cec9bc62>video</a>.</p><p>The two articles I took examples from for the dimension-lifted
transposition approach are <a href=https://web.cs.ucla.edu/~pouchet/doc/cc-article.11.pdf>Henretty et al. (2011), <em>Data Layout
Transformation for Stencil Computations on Short-Vector SIMD
Architectures</em></a>,
and <a href=https://arxiv.org/pdf/1512.03487.pdf>Boyle et al. (2015), <em>Grid: A next generation data parallel C++
QCD library</em></a>. One example of
the same approach applied to unstructured problems is shown in <a href=https://arxiv.org/pdf/1903.08243.pdf>Sun
et al. (2020), <em>A study of vectorization for matrix-free finite
element methods</em></a>.</p></li><li><p><a href=https://scicomp-durham.github.io/COMP52315/lecture-slides/2020-21/08.pdf>Session 8</a>,
<a href=https://web.microsoftstream.com/video/1bc1a757-9a7a-4b08-b88b-5ef523819a0c>video</a></p><p>We did a walkthrough of doing a roofline analysis. I got a bit
confused with the data in the plots from the slides, so we did it
live with the BLIS GEMM implementation. Those are the drawn-in points
in the annotated slides.</p><p>I then looked at application of some of the ideas in the course to
the <a href=https://www.firedrakeproject.org/>Firedrake</a> finite element
system. We did the dimension-lifted transposition approach on
unstructured data (rather than the structured grids that we looked
at last time).</p><p>Finally we tried to build the coursework code to check that it will
work when you do it. Only to find it didn&rsquo;t, so I updated the PETSc
install on Hamilton and rebuilt things, so I hope that the same
approach should work for you. Please get in touch if it doesn&rsquo;t (or
there are things that you don&rsquo;t understand).</p></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/scicomp-durham/COMP52315/commit/5e994206d6719c797436471e6da757e835e3610b title="Last modified by Massimiliano Fasi | February 8, 2023" target=_blank rel=noopener><img src=/COMP52315/svg/calendar.svg class=book-icon alt=Calendar>
<span>February 8, 2023</span></a></div><div><a class="flex align-center" href=https://github.com/scicomp-durham/COMP52315/edit/main/site/content//past-editions/2020-21/_index.md target=_blank rel=noopener><img src=/COMP52315/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><div class="flex flex-wrap align-right"><p>© 2020&ndash;2023 <a href=mailto:lawrence@wence.uk>Lawrence Mitchell</a>, <a href=mailto:massimiliano.fasi@durham.ac.uk>Massimiliano Fasi</a>, and <a href=https://www.dur.ac.uk/>Durham University</a>.</p><p><a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/><img alt="Creative Commons License" style=border-width:0 src=/COMP52315/cc-by-sa.svg></a>
This work is licensed under a <a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/>Creative
Commons Attribution-ShareAlike 4.0 International License</a>.</p></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#slides-20202021-edition>Slides 2020/2021 edition</a></li></ul></nav></aside></main></body></html>